(this["webpackJsonpmatx-react-pro"]=this["webpackJsonpmatx-react-pro"]||[]).push([[36],{1382:function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));var n=t(3),r=t(0),c=t.n(r),s=t(353),o=t(1374);function i(e){const a=Object(n.a)({},e),t=a.message,r=a.type;return c.a.createElement(c.a.Fragment,null,c.a.createElement(s.a,{container:!0,spacing:0,alignContent:"center",justify:"center"},c.a.createElement(s.a,{item:!0}),c.a.createElement(o.a,{color:"error"===r?"secondary":"primary"})," ",c.a.createElement("span",null,t,".")))}},1389:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(20),r=t.n(n),c=t(39),s=t(75);function o(e){return i.apply(this,arguments)}function i(){return(i=Object(c.a)(r.a.mark((function e(a){var t,n,c,o,i,l,u,m,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.fichier,n=a.nom,c=a.modele,o=a.champ,i=a.objet,l=a.obj,u=a.handleprogress,(m=new FormData).append(l.cle,i.id),m.append("modele",c),m.append("champ",o),m.append("nom",n),m.append("cle",l.cle),m.append("valeur",l.valeur),m.append("file",t),e.next=11,s.b.post("/medias/upload",m,{herdears:{"Content-Type":"multipart/form-data"},onUploadProgress:u});case 11:return d=e.sent,e.abrupt("return",d.data);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},1390:function(e,a,t){"use strict";t.d(a,"a",(function(){return n}));const n={selectableRows:"none",textLabels:{body:{noMatch:"Auccun enregistrement trouv\xe9",toolTip:"tri",columnHeaderTooltip:e=>"tri pour ".concat(e.label)},pagination:{next:"Page suivante",previous:"Page pr\xe9c\xe9dente",rowsPerPage:"Lignes par page:",displayRows:"sur"},toolbar:{search:"Rechercher",downloadCsv:"T\xe9l\xe9charger en CSV",print:"Imprimer",viewColumns:"Afficher les collones",filterTable:"Fiiltrer la table"},filter:{all:"Tout",title:"FILTRES",reset:"RESET"},viewColumns:{title:"Afficher les collones",titleAria:"Afficher/Cacher les collones"},selectedRows:{text:"lignes(s) s\xe9lection\xe9es",delete:"Supprimer",deleteAria:"Supprimer les lignes s\xe9lectionn\xe9es"}}}},1423:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(20),r=t.n(n),c=t(39),s=t(75);class o{getTouslesMagasins(e,a,t,n){return Object(c.a)(r.a.mark((function t(){var n;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e+=1,t.next=3,s.b.get("/magasins?itemsPerPage=".concat(a,"&page=").concat(e));case 3:return n=t.sent,t.abrupt("return",n.data);case 5:case"end":return t.stop()}}),t)})))()}ajoutMagasin(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.post("/magasins",e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}miseajourMagasin(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/magasins/"+e.id,e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}suppressionMagasin(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.delete("/magasins/"+e.id,{method:"DELETE",herdears:{Accept:"application/json"}});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}}},1447:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(20),r=t.n(n),c=t(39),s=t(75);class o{getTouslesStocks(e,a,t,n){return Object(c.a)(r.a.mark((function n(){var c,o,i,l,u,m;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e+=1,n.next=3,s.b.get("/stocks?itemsPerPage=".concat(a,"&page=").concat(e,"&produit=").concat(null!==(c=null===t||void 0===t||null===(o=t.produit)||void 0===o?void 0:o.id)&&void 0!==c?c:"","&magasin=").concat(null!==(i=null===t||void 0===t||null===(l=t.magasin)||void 0===l?void 0:l.id)&&void 0!==i?i:"","&actif=").concat(null!==(u=t.actif)&&void 0!==u?u:""));case 3:return m=n.sent,n.abrupt("return",m.data);case 5:case"end":return n.stop()}}),n)})))()}ajoutStock(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.post("/stocks",e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}miseajourStock(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/stocks/"+e.id,e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}suppressionStock(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.delete("/stocks/"+e.id,{method:"DELETE",herdears:{Accept:"application/json"}});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}togleactifStock(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/stocks/"+e.id,{actif:!e.actif});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}getStockActifDeMagasin(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.get("/stocks?itemsPerPage=1000&page=0&magasin=".concat(e.id,"&actif=1"));case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}}},1499:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(20),r=t.n(n),c=t(39),s=t(75);class o{getTouslesClients(e,a,t,n){return Object(c.a)(r.a.mark((function n(){var c;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e+=1,n.next=3,s.b.get("/clients?itemsPerPage=".concat(a,"&page=").concat(e,"&id=").concat(t," "));case 3:return c=n.sent,n.abrupt("return",c.data);case 5:case"end":return n.stop()}}),n)})))()}ajoutClient(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.post("/clients",e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}miseajourClient(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/clients/"+e.id,e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}suppressionClient(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.delete("/clients/"+e.id,{method:"DELETE",herdears:{Accept:"application/json"}});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}togleactifClient(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/clients/"+e.id,{actif:!e.actif});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}misajourStatutClient(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("clients/"+e.id,{statut:e.statut});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}togleestsocieteClient(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/clients/"+e.id,{estsociete:!e.estsociete});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}}},1500:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(20),r=t.n(n),c=t(39),s=t(75);class o{getTouslesAdresses(e,a,t,n){return Object(c.a)(r.a.mark((function n(){var c;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e+=1,n.next=3,s.b.get("/adresses?itemsPerPage=".concat(a,"&page=").concat(e,"&id=").concat(t," "));case 3:return c=n.sent,n.abrupt("return",c.data);case 5:case"end":return n.stop()}}),n)})))()}ajoutAdresse(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.post("/adresses",e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}miseajourAdresse(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/adresses/"+e.id,e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}suppressionAdresse(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.delete("/adresses/"+e.id,{method:"DELETE",herdears:{Accept:"application/json"}});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}togleestprincipaleAdresse(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/adresses/"+e.id,{estprincipale:!e.estprincipale});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}}},1501:function(e,a,t){"use strict";const n={supprimerUnElementDuTableau:(e,a)=>(e.splice(a,1),e)};a.a=n},1578:function(e,a,t){"use strict";t.d(a,"a",(function(){return o}));var n=t(20),r=t.n(n),c=t(39),s=t(75);class o{getTouslesCommandes(e,a,t,n){return Object(c.a)(r.a.mark((function n(){var c;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e+=1,n.next=3,s.b.get("/commandes?itemsPerPage=".concat(a,"&page=").concat(e,"&id=").concat(t," "));case 3:return c=n.sent,n.abrupt("return",c.data);case 5:case"end":return n.stop()}}),n)})))()}ajoutCommande(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.post("/commandes",e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}miseajourCommande(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("/commandes/"+e.id,e);case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}suppressionCommande(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.delete("/commandes/"+e.id,{method:"DELETE",herdears:{Accept:"application/json"}});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}misajourStatutCommande(e){return Object(c.a)(r.a.mark((function a(){var t;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,s.b.put("commandes/statut/"+e.id,{statut:e.statut});case 2:return t=a.sent,a.abrupt("return",t.data);case 4:case"end":return a.stop()}}),a)})))()}}},2051:function(e,a,t){"use strict";t.r(a);var n=t(3),r=t(17),c=t(0),s=t.n(c),o=t(1578),i=t(133),l=t(1404),u=t.n(l),m=t(1390),d=t(447),p=t(2028),g=t(451),b=t(1377),f=t(356),v=t(354),h=t(355),j=t(1382),E=(t(1405),t(1406),t(75)),O=t(2038),y=t(2034),x=t(2035),C=t(1385),w=t(1381),k=t(1384),S=t(1727),P=t(1501),q=t(1447),A=t(353),M=t(2023),T=t(623),L=t(2022),N=t(624),R=t(1682),D=t(2021),F=t(1371),I=t(50);function Q(e){const a=e.state,t=e.fonctions,n=e.queries;return s.a.createElement("div",null,s.a.createElement(A.a,{container:!0,spacing:4,justify:"center"},s.a.createElement(A.a,{item:!0,lg:8,md:8,sm:12,xs:12},s.a.createElement(F.a,{theme:Object(E.a)()},s.a.createElement(I.ValidatorForm,{onSubmit:t.allerADetails,onError:e=>console.log(e)},s.a.createElement(b.a,null,s.a.createElement(M.a,{action:s.a.createElement(T.a,{"aria-label":"",onClick:t.AnnulerEnregistrement},"x"),title:"Magasins consern\xe9s par le transfert",subheader:""}),s.a.createElement(L.a,{className:" px-6 pt-6 pb-6"}," ",s.a.createElement(A.a,{container:!0,spacing:4,direction:"column"},n.queryMagasins.isLoading?s.a.createElement(j.a,{message:"Chargement des magasins"}):s.a.createElement(s.a.Fragment,null,s.a.createElement(A.a,{item:!0},n.queryClients.isLoading?s.a.createElement(j.a,{message:"chargement des magasins"}):s.a.createElement(N.a,{fullWidth:!0},s.a.createElement(I.SelectValidator,{fullWidth:!0,id:"client",name:"client",value:a.commande.client,validators:["required"],errorMessages:["Le client est requis"],onChange:t.handleChange},n.queryClients.data.rows.map(e=>s.a.createElement(R.a,{key:e.id,value:e.id},e.nom))))),s.a.createElement(A.a,{item:!0},n.queryMagasins.isLoading?s.a.createElement(j.a,{message:"chargement des magasins"}):s.a.createElement(I.SelectValidator,{fullWidth:!0,name:"magasin",value:a.commande.magasin,validators:["required"],errorMessages:["Le magasin est requis"],onChange:t.handleChange},n.queryMagasins.data.rows.map(e=>s.a.createElement(R.a,{key:e.id,value:e.id},e.nom)))),s.a.createElement(A.a,{item:!0},s.a.createElement(I.TextValidator,{value:a.commande.adresse,fullWidth:!0,id:"adresse",name:"adresse",label:"Adresse de livraison",validators:[],errorMessages:["Adresse de livraison obligatoire"],onChange:t.handleChange}))))),s.a.createElement(D.a,null,s.a.createElement(A.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(A.a,{item:!0},s.a.createElement(g.a,{variant:"outlined",color:"secondary",onClick:t.AnnulerEnregistrement},"Annuler")),s.a.createElement(A.a,{item:!0},s.a.createElement(g.a,{color:"primary",variant:"contained",type:"submit"},s.a.createElement("span",{className:"pl-2 capitalize"},s.a.createElement(d.a,null," Suivant >>"))))))))))))}var B=t(1683),V=t(2041),H=t(1691),z=t(1686),W=t(1685),J=t(627),U=t(449),Y=t(1374),_=t(2044);function G(e){const a=e.state,t=e.fonctions,n=e.queries;return s.a.createElement("div",null,s.a.createElement(A.a,{container:!0,spacing:1,justify:"center"},s.a.createElement(A.a,{item:!0,lg:12,md:12,sm:12,xs:12},s.a.createElement(F.a,{theme:Object(E.a)()},s.a.createElement(b.a,{className:" px-6 pt-6 pb-6"},s.a.createElement(M.a,{action:s.a.createElement(T.a,{"aria-label":"",onClick:t.AnnulerEnregistrement},"x"),title:"client:".concat(a.commande.Client.nom," \n                               "),subheader:"\n                                magasin: ".concat(a.commande.Magasin.nom)}),s.a.createElement(L.a,{className:" px-6 pt-6 pb-6"}," ",s.a.createElement("form",null,s.a.createElement(A.a,{container:!0,spacing:4,direction:"column"},s.a.createElement(A.a,{item:!0},s.a.createElement(B.a,{className:"mb-4"},s.a.createElement(V.a,null,s.a.createElement(H.a,{className:"bg-default"},s.a.createElement(z.a,{key:"numero",align:"left",className:"pl-sm-24"},"#"),s.a.createElement(z.a,{key:"produit",align:"left",className:"pl-sm-24"},"Produit"),s.a.createElement(z.a,{key:"quantite",align:"right",className:"pl-sm-24"},"Quantit\xe9"),s.a.createElement(z.a,{key:"pu",align:"right",className:"pl-sm-24"},"Prix unitaire"),s.a.createElement(z.a,{key:"pt",align:"right",className:"pl-sm-24"},"Prix total"),s.a.createElement(z.a,{key:"action",align:"right",className:" pl-sm-24"},"Action"))),s.a.createElement(W.a,null,a.commande.Lignecommandes.map((e,a)=>{var r,c,o;return s.a.createElement(s.a.Fragment,null,s.a.createElement(H.a,{key:a},s.a.createElement(z.a,{className:"pl-sm-24 capitalize",align:"left"},a+1),s.a.createElement(z.a,{className:"pl-sm-24 capitalize",align:"left"},n.queryStocks.isLoading?s.a.createElement(j.a,{message:"chargement des produits"}):s.a.createElement(s.a.Fragment,null,s.a.createElement(N.a,{fullWidth:!0},s.a.createElement(J.a,{value:e.stock,label:"Produit",name:"stock",key:"stock",variant:"outlined",id:"stock".concat(a),onChange:e=>{t.handleSelectionStock(e,a)}},n.queryStocks.data.rows.map(e=>s.a.createElement(R.a,{key:e.id,value:e.id},e.Produit.nom)))))),s.a.createElement(z.a,{className:"pl-sm-24 capitalize",align:"right"},s.a.createElement(U.a,{id:"quantite",type:"number",fullWidth:!0,value:null!==(r=null===e||void 0===e?void 0:e.quantite)&&void 0!==r?r:1,label:"Quantite",name:"quantite",key:"quantite",variant:"outlined",onChange:e=>{t.handleChangeQuantite(e,a)}})),s.a.createElement(z.a,{className:"pl-sm-24 capitalize",align:"right"},s.a.createElement(U.a,{id:"prixunitaire",type:"number",fullWidth:!0,value:null!==(c=null===e||void 0===e?void 0:e.prixunitaire)&&void 0!==c?c:0,label:"Prix unitaire",name:"prixunitaire",key:"prixunitaire",variant:"outlined"})),s.a.createElement(z.a,{className:"pl-sm-24 capitalize",align:"right"},s.a.createElement(U.a,{id:"prixtotal",type:"number",fullWidth:!0,value:null!==(o=null===e||void 0===e?void 0:e.prixtotal)&&void 0!==o?o:1,label:"Prix total",name:"prixtotal",key:"prixtotal",variant:"outlined"})),s.a.createElement(z.a,{className:"pl-sm-24 capitalize",align:"right"},s.a.createElement(g.a,{variant:"contained",color:"secondary",onClick:()=>t.handleClickSurSupprimer(a)},"Supprimer"))))}),s.a.createElement(H.a,null,s.a.createElement(z.a,{colSpan:4,align:"right"},s.a.createElement(d.a,{variant:"h6"},"Sous total")),s.a.createElement(z.a,{align:"right"},s.a.createElement(d.a,null,a.commande.soustotal))),s.a.createElement(H.a,null,s.a.createElement(z.a,{colSpan:4,align:"right"},s.a.createElement(d.a,{variant:"h6"},"Taxe")),s.a.createElement(z.a,{align:"right"},a.commande.taxe)),s.a.createElement(H.a,null,s.a.createElement(z.a,{colSpan:4,align:"right"},s.a.createElement(d.a,{variant:"h6"},"Total")),s.a.createElement(z.a,{align:"right"},s.a.createElement(d.a,{variant:"h6"},a.commande.montant))))),s.a.createElement("div",{className:"flex justify-end px-4 mb-4"},s.a.createElement(g.a,{variant:"contained",color:"primary",onClick:t.handleClickSurAjouter},"Ajouter un produit")))))),s.a.createElement(D.a,null,s.a.createElement(A.a,{container:!0,alignItems:"center",justify:"space-between"},s.a.createElement(A.a,{item:!0},s.a.createElement(g.a,{variant:"outlined",color:"secondary",onClick:t.handleClickSurPrecedent},"<< Pr\xe9c\xe9dent")),s.a.createElement(A.a,{item:!0},s.a.createElement(g.a,{color:"primary",variant:"contained",onClick:t.handleClickSurEnregistrer},n.mutationMiseajour.isLoading||n.mutationAjout.isLoading?s.a.createElement(Y.a,{color:"inherit"}):s.a.createElement(_.a,null),s.a.createElement("span",{className:"pl-2 capitalize"},"Enregistrer"))))))))))}function K(e){const a=e.state,t=e.fonctions,o=e.queries,l=e.queryClient,u={id:1,stock:0,quantite:1,prixunitaire:0,prixtotal:0},m=Object(c.useState)(Object(n.a)(Object(n.a)({},a),{},{etape:0,etapes:[{index:0,label:"Informations sur le client"},{index:1,label:"D\xe9tails de la commande"}],rechercheStock:{produit:{id:""},magasin:{id:""},actif:1}})),p=Object(r.a)(m,2),b=p[0],f=p[1],v=new q.a;t.allerAClient=()=>{f(Object(n.a)(Object(n.a)({},b),{},{etape:0}))},t.handleChange=({target:{name:e,value:a}})=>{let t=Object(n.a)({},b.commande);t[e]=a,f(Object(n.a)(Object(n.a)({},b),{},{commande:Object(n.a)(Object(n.a)({},b.commande),t)}))},console.log("*********** ".concat(JSON.stringify(b.commande),"******************")),t.allerADetails=()=>{var e=o.queryMagasins.data.rows.find(e=>e.id===+b.commande.magasin),a=o.queryClients.data.rows.find(e=>e.id===+b.commande.client);f(Object(n.a)(Object(n.a)({},b),{},{commande:Object(n.a)(Object(n.a)({},b.commande),{},{Client:null!==a&&void 0!==a?a:0,Magasin:null!==e&&void 0!==e?e:0}),rechercheStock:Object(n.a)(Object(n.a)({},b.rechercheStock),{},{magasin:{id:b.commande.magasin}}),etape:1}))},t.handleSelectionStock=(e,a)=>{var t=b.commande.Lignecommandes;t[a].stock=e.target.value;const r=o.queryStocks.data.rows.find(e=>e.id===t[a].stock);let c=r.prixdedetail;b.commande.quantite>=r.quantitedegros?c=r.prixdegros:b.commande.quantite>=r.quantitededemisgros&&(c=r.prixdedemigros),t[a].prixunitaire=c,t[a].prixtotal=t[a].quantite*c,console.log("*********** ".concat(JSON.stringify(t),"******************"));const s=E(t,b.commande.taxe);f(Object(n.a)(Object(n.a)({},b),{},{commande:Object(n.a)(Object(n.a)({},b.commande),{},{Lignecommandes:t,soustotal:s.sousTotal,montant:s.total})}))},t.handleClickSurSupprimer=e=>{var a=b.commande.Lignecommandes;a=P.a.supprimerUnElementDuTableau(a,e);const t=E(a,b.commande.taxe);f(Object(n.a)(Object(n.a)({},b),{},{commande:Object(n.a)(Object(n.a)({},b.commande),{},{Lignecommandes:a,soustotal:t.sousTotal,montant:t.total})}))},t.handleClickSurAjouter=()=>{var e=b.commande.Lignecommandes;e.push(u),f(Object(n.a)(Object(n.a)({},b),{},{commande:Object(n.a)(Object(n.a)({},b.commande),{},{Lignecommandes:e})}))},t.handleChangeQuantite=(e,a)=>{var t=b.commande.Lignecommandes;t[a].quantite=e.target.value;const r=o.queryStocks.data.rows.find(e=>e.id===t[a].stock);let c=r.prixdedetail;e.target.value>=r.quantitedegros?c=r.prixdegros:e.target.value>=r.quantitededemisgros&&(c=r.prixdedemigros),t[a].prixunitaire=c,t[a].prixtotal=t[a].quantite*c;const s=E(t,b.commande.taxe);f(Object(n.a)(Object(n.a)({},b),{},{commande:Object(n.a)(Object(n.a)({},b.commande),{},{Lignecommandes:t,soustotal:s.sousTotal,montant:s.total})}))},t.handleClickSurPrecedent=()=>{f(Object(n.a)(Object(n.a)({},b),{},{etape:0}))},t.handleClickSurEnregistrer=()=>{console.log("***********enregistrement d'une nouvelle commande******************"),console.log(b.commande),t.enregistrerCommande(b.commande)};const h=C.b().shape({magasin:C.c().required("Le magasin est requis"),client:C.c().required("Le client est requis")}),j={commande:Object(w.c)({resolver:Object(k.yupResolver)(h),defaultValues:b.commande})};o.queryStocks=Object(i.useQuery)(["Stock",b.rechercheStock],()=>v.getTouslesStocks(0,1e3,b.rechercheStock,""),{keepPreviousData:!0});const E=(e,a)=>e.reduce((e,t)=>({sousTotal:e.sousTotal+t.prixtotal,total:e.sousTotal+t.prixtotal+(.01*a*(e.sousTotal+t.prixtotal)+a)}),{sousTotal:0,total:0});return s.a.createElement(S.a,{sx:{width:"100%"}},s.a.createElement(O.a,{nonLinear:!0,activeStep:b.etape},b.etapes.map(e=>s.a.createElement(y.a,{key:e.label,completed:b.etape>e.index},s.a.createElement(x.a,{color:"inherit"},e.label)))),s.a.createElement("div",null,b.complet?s.a.createElement(s.a.Fragment,null,s.a.createElement(d.a,{sx:{mt:2,mb:1}},"F\xe9licitation, toutes les \xe9tapes ont \xe9t\xe9 achev\xe9s."),s.a.createElement(S.a,{sx:{display:"flex",flexDirection:"row",pt:2}},s.a.createElement(S.a,{sx:{flex:"1 1 auto"}}),s.a.createElement(g.a,{onClick:t.fermerFormulaire},"Quitter"))):s.a.createElement(s.a.Fragment,null,0===b.etape?s.a.createElement(Q,{state:b,fonctions:t,queries:o,useforms:j,queryClient:l}):1===b.etape?s.a.createElement(G,{state:b,fonctions:t,queries:o,useforms:j,queryClient:l}):s.a.createElement("span",null,"Autre"))))}var X=e=>{var a,t;const r=e.state,c=e.fonctions,o=e.collonnes,i=e.queries,l=e.useform,E=e.onSubmit,O=e.queryClient;return s.a.createElement("div",{className:"m-sm-30"},s.a.createElement(f.a,{message:r.alert.message,severity:r.alert.severity,open:r.alert.open,handleAlertClose:!0===r.alert.automaticClose?()=>c.handleFermetureAlerte():()=>c.fermerAlerte()}),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(v.a,{routeSegments:[{name:r.titre}]})),s.a.createElement("div",{className:"mb-sm-30"},s.a.createElement(d.a,{variant:"h4"},r.titre)),"affichage"===r.pagestate.mode?s.a.createElement(p.a,{in:r.pagestate.affichageTable,direction:"right",unmountOnExit:!0},s.a.createElement("div",null,s.a.createElement(g.a,{className:"mb-4",variant:"contained",color:"primary",onClick:()=>c.handleClicksurNouveau()},"Nouvelle commande"),i.queryCommandes.isLoading?s.a.createElement(j.a,{message:"Chargement des donn\xe9es...",type:"info"}):i.queryCommandes.isError?s.a.createElement(j.a,{message:"Erreur lors du chargement des donn\xe9es::"+i.queryCommandes.error,type:"error"}):s.a.createElement(u.a,{title:r.titre,data:i.queryCommandes.data.rows.map(e=>({commande:e})),columns:o,options:Object(n.a)(Object(n.a)({},m.a),{},{serverSide:!0,count:i.queryCommandes.data.count,rowsPerPageOptions:[20,30,50],rowsPerPage:r.tableconfig.rowsPerPage,textLabels:Object(n.a)(Object(n.a)({},m.a.textLabels),{},{toolbar:Object(n.a)(Object(n.a)({},m.a.textLabels.toolbar),{},{search:"Rechercher par id"})}),onChangePage:e=>c.handleChangePage(e),onChangeRowsPerPage:e=>c.handleChangeRowPerPage(e),onSearchChange:e=>c.handleSearchChange(e),onFilterChange:()=>c.handleFilterChange()})}),s.a.createElement(b.a,{className:"w-full overflow-auto",elevation:8},s.a.createElement(h.a,{open:r.dialogueSuppressionOuvert,onConfirmDialogClose:c.fermerDialogueSuppression,onYesClick:c.confirmerSuppression,text:null!==(a="Confirmez la suppression de "+(null===(t=r.commande)||void 0===t?void 0:t.nom))&&void 0!==a?a:""})))):s.a.createElement(K,{state:r,fonctions:c,queries:i,useform:l,onSubmit:E,queryClient:O}))},Z=t(13),$=t(87),ee=t(2046),ae=t(1410),te=t(1411),ne=t(2045),re=t(343),ce=t(1331),se=t(1375),oe=t(2014),ie=t(1436);Object(re.a)(e=>{e.palette,Object(Z.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}});function le(e){const a=Object(re.a)(e=>{e.palette,Object(Z.a)(e,["palette"]);return{userMenu:{display:"flex",alignItems:"center",cursor:"pointer",borderRadius:24,padding:4,"& span":{margin:"0 8px"}},menuItem:{display:"flex",alignItems:"center",minWidth:185}}}),t=e=>{switch(e.statut){case"Annul\xe9e":return"bg-error";case"Nouveau":return"bg-primary";case"Valid\xe9e":return"bg-green";case"Livr\xe9e":return"bg-gray";case"Factur\xe9e":return"bg-dark";default:return"bg-primary"}},n=(a,t)=>{e.handleClickSurAction(a,t)};return[{name:"commande",label:"ID",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n,r;return null!==(n=null===(r=e.id)||void 0===r?void 0:r.toLocaleString("fr-FR"))&&void 0!==n?n:""}}},{name:"commande",label:"Dates",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>s.a.createElement(s.a.Fragment,null,s.a.createElement("small",{style:{whiteSpace:"nowrap"}},"Commande:  ",null==e.datecommande?"":Object(oe.a)(Object(ie.a)(e.datecommande),"dd/MM/yyyy HH:mm")),s.a.createElement("br",null),e.datevalidation&&s.a.createElement("small",{style:{whiteSpace:"nowrap"}},"Validation:  ",null==e.datevalidation?"":Object(oe.a)(Object(ie.a)(e.datevalidation),"dd/MM/yyyy HH:mm")),s.a.createElement("br",null),e.datefacturation&&s.a.createElement("small",{style:{whiteSpace:"nowrap"}},"Facturation:  ",null==e.datefacturation?"":Object(oe.a)(Object(ie.a)(e.datefacturation),"dd/MM/yyyy HH:mm")),s.a.createElement("br",null),e.datelivraison&&s.a.createElement("small",{style:{whiteSpace:"nowrap"}},"Livraison:  ",null==e.datelivraison?"":Object(oe.a)(Object(ie.a)(e.datelivraison),"dd/MM/yyyy HH:mm")),s.a.createElement("br",null),e.dateannulation&&s.a.createElement("small",{style:{whiteSpace:"nowrap"}},"Annulation:  ",null==e.dateannulation?"":Object(oe.a)(Object(ie.a)(e.dateannulation),"dd/MM/yyyy HH:mm")))}},{name:"commande",label:"client",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n,r;return null!==(n=null===(r=e.Client)||void 0===r?void 0:r.nom)&&void 0!==n?n:""}}},{name:"commande",label:"magasin",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n,r;return null!==(n=null===(r=e.Magasin)||void 0===r?void 0:r.nom)&&void 0!==n?n:""}}},{name:"commande",label:"Montant HT",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n,r;return null!==(n=null===(r=e.soustotal)||void 0===r?void 0:r.toLocaleString("fr-FR"))&&void 0!==n?n:""}}},{name:"commande",label:"Taxe",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n;return null!==(n=e.taxe)&&void 0!==n?n:""}}},{name:"commande",label:"Montant total",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n,r;return null!==(n=null===(r=e.montant)||void 0===r?void 0:r.toLocaleString("fr-FR"))&&void 0!==n?n:""}}},{name:"commande",label:"Validit\xe9",options:{filter:!1,sort:!1,display:!1,customBodyRender:(e,a,t)=>{var n,r;return null!==(n=null===(r=e.validite)||void 0===r?void 0:r.toLocaleString("fr-FR"))&&void 0!==n?n:""}}},{name:"commande",label:"Adresse de livraison",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,a,t)=>{var n;return null!==(n=e.adresse)&&void 0!==n?n:""}}},{name:"commande",label:"Statut",options:{filter:!1,sort:!1,display:!0,customBodyRender:(n,r,c)=>s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement($.j,{menuButton:s.a.createElement("div",{className:a.userMenu},s.a.createElement(ce.a,{xsDown:!0},s.a.createElement(g.a,{size:"small",variant:"text",color:"primary",endIcon:s.a.createElement(ne.a,null)},s.a.createElement("small",{className:"border-radius-4  text-white px-2 py-2px "+t({id:n.id,statut:n.statut})},n.statut))))},(e=>{switch(e.statut){case"Annul\xe9e":return[];case"Nouveau":return[{id:1,nom:"Valider",statut:"Valid\xe9e"},{id:2,nom:"Annuler",statut:"Annul\xe9e"}];case"Valid\xe9e":return[{id:1,nom:"Facturer",statut:"Factur\xe9e"},{id:2,nom:"Annuler",statut:"Annul\xe9e"}];case"Factur\xe9e":return[{id:1,nom:"Livrer",statut:"Livr\xe9e"}];default:return[]}})(n).map(a=>s.a.createElement(R.a,{onClick:()=>e.handleChangementStatut({id:n.id,statut:a.statut}),key:a.id,value:a.statut},a.nom)))))}},{name:"commande",label:"Actions",options:{filter:!1,sort:!1,display:!0,customBodyRender:(e,t,r)=>s.a.createElement("div",null,s.a.createElement($.j,{menuButton:s.a.createElement("div",{className:a.userMenu},s.a.createElement(ce.a,{xsDown:!0},s.a.createElement(g.a,{size:"small",variant:"outlined",color:"primary",endIcon:s.a.createElement(ne.a,null)},"Actions")))},(e=>{switch(e.statut){case"Annul\xe9":return[{id:1,nom:"Imprimer",action:e=>n(e,"Imprimer"),icon:s.a.createElement(ee.a,{color:"primary"})}];case"Nouveau":return[{id:1,nom:"Imprimer",action:e=>n(e,"Imprimer"),icon:s.a.createElement(ee.a,{color:"primary"})},{id:2,nom:"Modifier",action:e=>n(e,"Modifier"),icon:s.a.createElement(ae.a,{color:"primary"})},{id:3,nom:"Supprimer",action:e=>n(e,"Supprimer"),icon:s.a.createElement(te.a,{color:"error"})}];default:return[{id:1,nom:"Imprimer",action:e=>n(e,"Imprimer"),icon:s.a.createElement(ee.a,{color:"primary"})}]}})(e).map(a=>s.a.createElement(R.a,{onClick:()=>a.action(e),key:a.id,value:a.statut},a.icon,"   ",s.a.createElement("span",{className:"ml-5"},a.nom),s.a.createElement(se.a,null)))))}}]}t(1389);var ue=t(1499),me=t(1423),de=t(1500);a.default=()=>{const e={nom:"",datecommande:"",montant:0,soustotal:0,remise:0,montantremise:0,taxe:0,validite:0,statut:"",client:0,magasin:0,adresse:"",Lignecommandes:[]},a={commande:e,commande1:null,titre:"Commandes clients",tableconfig:{page:0,rowsPerPage:30,recherche:"",filtre:""},pagestate:{mode:"affichage",action:"ajout",affichageTable:!0},alert:{severity:"severity",message:"",open:!1,automaticClose:!1},dialogueSuppressionOuvert:!1,rechercheStock:{produit:{id:""},magasin:{id:""}}},t=Object(c.useState)(a),l=Object(r.a)(t,2),u=l[0],m=l[1];let d=new o.a,p=new ue.a,g=new me.a,b=new de.a;new q.a;const f=Object(i.useQueryClient)(),v=Object(i.useMutation)(d.misajourStatutCommande,{onSuccess:()=>{m(Object(n.a)(Object(n.a)({},u),{},{alert:{message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0}}))},onError:()=>{m(Object(n.a)(Object(n.a)({},u),{},{alert:{message:"Echec lors de l'enregistrement",open:!0,severity:"error",automaticClose:!0}}))},onSettled:()=>{f.invalidateQueries("Commandes")}}),h={handleFermetureAlerte:()=>{m(Object(n.a)(Object(n.a)({},u),{},{titre:"Commandes clients",alert:Object(n.a)(Object(n.a)({},u.alert),{},{open:!1}),pagestate:Object(n.a)(Object(n.a)({},u.pagestate),{},{mode:"affichage",affichageTable:!0})}))},handleClicksurNouveau:()=>{m(Object(n.a)(Object(n.a)({},u),{},{commande:e,titre:"Nouvelle commande",pagestate:{mode:"edition",action:"ajout",affichageTable:!1}}))},fermerAlerte:()=>{m(Object(n.a)(Object(n.a)({},u),{},{alert:Object(n.a)(Object(n.a)({},u.alert),{},{open:!1})}))},AnnulerEnregistrement:()=>{console.log("Annulation de l'enregistrement"),m(Object(n.a)(Object(n.a)({},u),{},{titre:"Commandes clients",pagestate:{mode:"affichage",action:"ajout",affichageTable:!0}}))},fermerDialogueSuppression:()=>{m(Object(n.a)(Object(n.a)({},u),{},{dialogueSuppressionOuvert:!1}))},confirmerSuppression:()=>{A.mutate(u.commande)},handleCloseDialoguephoto:()=>{m(Object(n.a)(Object(n.a)({},u),{},{dialoguephoto:Object(n.a)(Object(n.a)({},u.dialoguephoto),{},{open:!1})}))},handleChangeRowPerPage:e=>{m(Object(n.a)(Object(n.a)({},u),{},{tableconfig:Object(n.a)(Object(n.a)({},u.tableconfig),{},{rowsPerPage:e})}))},handleSearchChange:e=>{m(Object(n.a)(Object(n.a)({},u),{},{tableconfig:Object(n.a)(Object(n.a)({},u.tableconfig),{},{recherche:e})}))},handleChangePage:e=>{m(Object(n.a)(Object(n.a)({},u),{},{tableconfig:Object(n.a)(Object(n.a)({},u.tableconfig),{},{page:e})}))},handleClickSurAction:(e,a)=>{switch(console.log(a),a){case"Imprimer":window.open("".concat(E.c,"/api/commandes/imprimer/").concat(e.id),"_blanc");break;case"Modifier":m(Object(n.a)(Object(n.a)({},u),{},{titre:"Mise \xe0 jour commande #"+e.id,commande:e,pagestate:{mode:"edition",action:"misajour",affichageTable:!1}}));break;case"Supprimer":m(Object(n.a)(Object(n.a)({},u),{},{commande:e,dialogueSuppressionOuvert:!0}))}},handledatedatecommandechange:e=>{m(Object(n.a)(Object(n.a)({},u),{},{commande:Object(n.a)(Object(n.a)({},u.commande),{},{datecommande:e})}))},handleChangementStatut:({id:e,statut:a})=>{v.mutate({id:e,statut:a})},updateStock:e=>{m(Object(n.a)(Object(n.a)({},u),{},{rechercheStock:Object(n.a)(Object(n.a)({},u.rechercheStock),{},{produit:e.produit,magasin:e.magasin})}))},enregistrerCommande:e=>{console.log("*********** ".concat(JSON.stringify(e),"******************")),e.id>0?(console.log("*********** ".concat(JSON.stringify("Mise \xe0 jour de la commande"),"******************")),P.mutate(e)):(console.log("*********** ".concat(JSON.stringify("Enregistrement de la nouvelle commande"),"******************")),S.mutate(e))}},j=Object(i.useQuery)(["Commandes",u.tableconfig.page,u.tableconfig.rowsPerPage,u.tableconfig.recherche,u.tableconfig.filtre],()=>d.getTouslesCommandes(u.tableconfig.page,u.tableconfig.rowsPerPage,u.tableconfig.recherche,u.tableconfig.filtre),{keepPreviousData:!0}),O=Object(i.useQuery)(["Clients",u.tableconfig.page,u.tableconfig.rowsPerPage,u.tableconfig.recherche,u.tableconfig.filtre],()=>p.getTouslesClients(0,1e3,u.tableconfig.recherche,u.tableconfig.filtre),{keepPreviousData:!0}),y=Object(i.useQuery)(["Magasins",u.tableconfig.page,u.tableconfig.rowsPerPage,u.tableconfig.recherche,u.tableconfig.filtre],()=>g.getTouslesMagasins(0,1e3,u.tableconfig.recherche,u.tableconfig.filtre),{keepPreviousData:!0}),x=Object(i.useQuery)(["Adresses",u.tableconfig.page,u.tableconfig.rowsPerPage,u.tableconfig.recherche,u.tableconfig.filtre],()=>b.getTouslesAdresses(0,1e3,u.tableconfig.recherche,u.tableconfig.filtre),{keepPreviousData:!0}),S=Object(i.useMutation)(d.ajoutCommande,{onSuccess:()=>{f.invalidateQueries("Commandes"),m(Object(n.a)(Object(n.a)({},u),{},{alert:{message:"Enregistrement r\xe9ussi",open:!0,severity:"success",automaticClose:!0}}))},onError:()=>{f.invalidateQueries("Commandes"),m(Object(n.a)(Object(n.a)({},u),{},{alert:{message:"Echec lors de l'enregistrement",open:!0,severity:"error",automaticClose:!0}}))}}),P=Object(i.useMutation)(d.miseajourCommande,{onSuccess:()=>{f.invalidateQueries("Commandes"),m(Object(n.a)(Object(n.a)({},u),{},{alert:{message:"Mise \xe0 jour R\xe9ussie.",open:!0,severity:"success",automaticClose:!0}}))},onError:()=>{f.invalidateQueries("Commandes"),m(Object(n.a)(Object(n.a)({},u),{},{alert:{message:"Echec lors de la mise \xe0 jour",open:!0,severity:"error",automaticClose:!0}}))}}),A=Object(i.useMutation)(d.suppressionCommande,{onSuccess:()=>{m(Object(n.a)(Object(n.a)({},u),{},{dialogueSuppressionOuvert:!1,alert:{message:"Supr\xe9ssion r\xe9ussie",open:!0,severity:"success"}}))},onError:()=>{m({alert:{message:"Echec lors de la supr\xe9ssion",open:!0,severity:"error"}})},onSettled:()=>{f.invalidateQueries("Commandes")}}),M={queryCommandes:j,mutationMiseajour:P,mutationAjout:S,mutationSuppression:A,queryClients:O,queryMagasins:y,queryAdresses:x},T=le(h),L=C.b().shape({}),N={magasin:Object(w.c)({resolver:Object(k.yupResolver)(L),defaultValues:{commande:u.commande}})};return s.a.createElement(X,{state:u,fonctions:h,collonnes:T,queries:M,useform:N,onSubmit:e=>{var a;let t=Object(n.a)(Object(n.a)({},u.commande),e);void 0!==(null===(a=u.commande)||void 0===a?void 0:a.id)?M.mutationMiseajour.mutate(Object(n.a)({},t)):M.mutationAjout.mutate(Object(n.a)({},t))},queryClient:f})}}}]);